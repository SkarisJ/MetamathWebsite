<!DOCTYPE html>
<html>
  <head>
    <title>Metamath Visualization</title>
    <link rel="stylesheet" href="https://pyscript.net/latest/pyscript.css" />
    <script defer src="https://pyscript.net/latest/pyscript.js"></script>
  </head>
  <body>
    <h1>Select a metamath file</h1>
    <input type="file" id="input" accept=".mm" />
    <div id="sections"/>
    <py-script>
    import os
    import asyncio
    import js
    import sys
    import json
    from js import document, FileReader
    from pyodide.ffi import create_proxy

    def handleFileSelect():
        file_event = create_proxy(process_file)
        e = document.getElementById("input")
        e.addEventListener("change", file_event, False)

    def process_file(event):
        file_list = document.getElementById("input").files
        for f in file_list:
            reader = FileReader.new()
            onload_event = create_proxy(read_complete)
            reader.onload = onload_event
            reader.readAsText(f)

    def read_complete(event):
        metamath_file = event.target.result

        # Handlint errorus
        os.system("python mmverify.py < simpleProof.mm 2> " + "test.log")

    handleFileSelect()
    </py-script>
  </body>
</html>

click_proxy = create_proxy(handleFileSelect)
e = document.getElementById("fileInput")
e.addEventListener("change", click_proxy)            